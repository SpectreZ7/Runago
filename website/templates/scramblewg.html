{% extends "base.html" %}
{% block title %}scramblegame{% endblock %}
{% block content %}
<head>
    <style>
    /* .vertical-text input[type= "text"]{
        margin-top: 400px;
    } */
    .vertical-text input{
        display: flex;
        width: 280px;
        min-height: 20px;
        font-size: 35px;
        /* flex-direction: column; */
    }
    #word-input{
        font-family: 'Open Sans', sans-serif;
        font-size: 35px;
    }
    .definition-container {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        text-align: center;
    }
    .definition-container p{
        font-family: 'Open Sans', sans-serif;
        font-size: 24px;
        color: rgb(254, 254, 254);
    }
    
    .center-content {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100%;
    }
    body {
        font-family: 'Open Sans', sans-serif;
    }
    .error{
        color:red;
        font-weight:bold;
    }
    input[type="text"] {
        border-radius: 15px;
    }
    #definition-form {
    position: absolute;
    top: 30%;
    left: 52%;
    transform: translate(-50%, -50%);
    display: flex;
    align-items: center;
    justify-content: center;
    }
    input[type="submit"] {
        background-color: #282f70;
        color: white;
        padding: 8px 16px;
        border-radius: 20px;
        border: none;
        font-size: 16px;
        cursor: pointer;
        font-weight:bold ;
        font-family: 'Roboto', sans-serif;
    }
    #add-word-button{
        background-color: #ff0000;
        color: white;
        /*please centre this button*/
        padding: 0px 55px;
        border-radius: 20px;
        border: none;
        font-size: 60px;
        cursor: pointer;

    }
    .difficulty-selection {
        position: absolute;
        left: 30px; 
        top: 20%;  
        transform: translateY(175%);
        border-radius: 10px;
        padding: 20px;
        background-color: #282f70;
        font-size: 16px;
        cursor: pointer;
        font-weight:bold ;
        font-family: 'Roboto', sans-serif;
    }
    .difficulty-selection label {
        display: block; /* Makes each label occupy its own line */
        color: white; /* Example text color to match your navbar */
        background-color: #282f70;
        margin: 10px;
        cursor: pointer;
        transition: background-color 0.3s;
        border-radius: 5px;
    }
    .difficulty-selection input[type="radio"] {
        accent-color: #3498db; 
        margin-right: 8px;
        opacity: 0;
        position: absolute;
        width: 0;
        height: 0;
    }

    .center-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh; /* Full viewport height */
    }

    #definition-form {
        position: absolute;
        top: 50%; /* Adjust as needed to lower the form */
        left: 50%;
        transform: translate(-50%, -50%);
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .vertical-text {
        max-height: 70vh; /* Adjust based on screen size */
        overflow-y: auto; /* Enables scrolling */
    }

    </style>
    
</head>

<div>
    <div>
        <!-- Difficulty Selection on the left -->
        <div class="difficulty-selection" style="position: absolute; left: 10px; top: 10px;">
            <label><input type="radio" name="difficulty" value="easy"> Easy (7 Words)</label><br>
            <label><input type="radio" name="difficulty" value="medium"> Medium (12 Words)</label><br>
            <label><input type="radio" name="difficulty" value="hard"> Hard (17 Words)</label>
        </div>
    
        <!-- Form with input fields in the center -->
        <form method="POST" action="{{ url_for('pages.scramblewg') }}" id="definition-form">
            <div class="center-content" style="display: flex; flex-direction: column; align-items: center;">
                <div class="vertical-text" id="word-inputs">
                    <!-- Input fields will be added here based on difficulty -->
                </div>
                <input type="submit" id="play-game-button" value="Play game" style="width: 150px; height: 50px; margin-top: 10px;">
            </div>
        </form>
    </div>
</div>


<script>
    // Function to create input fields based on difficulty
    function createInputFields(numberOfFields) {
        const container = document.getElementById("word-inputs");
        container.innerHTML = ''; // Clear existing fields if any
        for (let i = 0; i < numberOfFields; i++) {
            var newInput = document.createElement("input");
            newInput.type = "text";
            // Apply any required styles to newInput if needed
            container.appendChild(newInput);
        }
    }
    // Event listener for difficulty selection
    document.querySelectorAll('input[name="difficulty"]').forEach(input => {
        input.addEventListener('change', function() {
            if (this.value === 'easy') {
                createInputFields(7);
            } else if (this.value === 'medium') {
                createInputFields(12);
            } else if (this.value === 'hard') {
                createInputFields(17);
            }
        });
    });

    let count = 0;
    var form = document.getElementById("definition-form");
    var input = document.getElementById("word-input");
    var error = document.createElement("p"  );
    error.classList.add("error");
    error.textContent = "Please enter a word.";
    error.style.display = "none";
    var addButton = document.getElementById("add-word-button");
    form.addEventListener("submit", function(e) {
        var inputs = document.querySelectorAll("#word-inputs input[type='text']");
        for (var input of inputs) {
            if (input.value === "") {
                e.preventDefault();
                // You can show an error message if needed
                break;
            }
        }
    });
 
    
   

    document.getElementById("play-game-button").addEventListener("click", function(event) {
        event.preventDefault();
        var words = Array.from(document.querySelectorAll(".vertical-text input[type='text']"))
            .map(function(input) { return input.value.trim(); })
            .filter(function(word) { return word.length > 0; });
        if (words.length > 0) {
            // The fetch function initiates an asynchronous HTTP request and returns a Promise. 
            // The Promise represents the eventual completion or failure of the request.
            fetch("/scrambleplay", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                    // Making a POST request to the "/scrambleplay" endpoint with JSON data.
                    // The request headers specify the content type as JSON.
                },
                body: JSON.stringify(words)
                
            })
            // Chain a promise using `then()` to handle the response from the server.
            .then(function(response) {
                // Handling the response from the server.
                if (response.ok) {
                    // Checking if the response was successful (status code 2xx).
                    return response.json();
                    // Parsing the response body as JSON.
                } else {
                    throw new Error("Network response was not ok.");
                }// Throwing an error if the response was not successful.
            })
            // Chain another promise using `then()` to handle the parsed JSON data from the previous `then()` callback.
            .then(function(data) {
                // Handling the parsed JSON data from the response.
                definitions = {}

                Object.keys(data.scrambled_definitions).forEach(word => {
                    definitions[word] = data.scrambled_definitions[word];
                });
                window.location.href = "/scrambleplay?definitions=" + encodeURIComponent(JSON.stringify(definitions));
            })
            // Chain the `catch()` method to handle any errors that occur in the promise chain.
            .catch(function(error) {
                console.error("Error:", error);
            });
        }
    });
</script>


{% endblock %}